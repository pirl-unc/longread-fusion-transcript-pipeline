
##### SYSTEM OPTIONS #####
#export TF_BASH=sbatch
export TF_BASH=bash

export DOCKER_SRC=/src #/src

## SCRATCH STORAGE DIRECTORY
export STORAGE_DIR=/mnt
#export STORAGE_DIR=/home/vantwisk/vantwisk/fusions/seq_run4
#export /datastore/scratch/users/vantwisk/sim2
[ ! -d ${STORAGE_DIR} ] && mkdir ${STORAGE_DIR}



export THREADS=32

## LONGREAD AND SHORTREAD READ SIMULATION SETTINGS
export N_TRANSCRIPTS='("canoncical")' #('1' '2' '4' '8' '16')
export REPLICATES='1' #10
export COVERAGE='(3 4 5)' #(3 5 10 30 50 100)
export QUALITY='("95,100,4")'  #('75,90,8' '87,97,5'  '95,100,4')
export TECH='("pacbio2021" "nanopore2023")'
export READ_LENGTHS='(150)'

## LONGGF OPTIONS
export MIN_OVERLAP_LEN=100
export BIN_SIZE=50
export MIN_MAP_LENGTH=100

## JAFFAL OPTIONS

## GENION OPTIONS
export GENION_MIN_SUPPORT=2

## PBFUSION OPTIONS
export PBFUSION_MIN_COVERAGE=2





##### AUTO CONFIG #####

## BASE STORAGE DIRECTORIES
export REF_STORAGE_DIR=${STORAGE_DIR}/ref
[ ! -d ${REF_STORAGE_DIR} ] && mkdir ${REF_STORAGE_DIR}
export SIM_STORAGE_DIR=${STORAGE_DIR}/sim
[ ! -d ${SIM_STORAGE_DIR} ] && mkdir ${SIM_STORAGE_DIR}
export RESULTS_STORAGE_DIR=${STORAGE_DIR}/results
[ ! -d ${RESULTS_STORAGE_DIR} ] && mkdir ${RESULTS_STORAGE_DIR}

## ALIGNMENT STORAGE DIRECTORY
export ALIGNMENT_STORAGE_DIR=${STORAGE_DIR}/alignments
[ ! -d ${ALIGNMENT_STORAGE_DIR} ] && mkdir ${ALIGNMENT_STORAGE_DIR}


export STAR_INDEX_STORAGE_DIR=${REF_STORAGE_DIR}/hg38_star_index

## RESULTS STORAGE DIRECTORIES
export JAFFAL_STORAGE_DIR=${RESULTS_STORAGE_DIR}/jaffal
[ ! -d ${JAFFAL_STORAGE_DIR} ] && mkdir ${JAFFAL_STORAGE_DIR}
export LONGGF_STORAGE_DIR=${RESULTS_STORAGE_DIR}/longgf
[ ! -d ${LONGGF_STORAGE_DIR} ] && mkdir ${LONGGF_STORAGE_DIR}
export GENION_STORAGE_DIR=${RESULTS_STORAGE_DIR}/genion
[ ! -d ${GENION_STORAGE_DIR} ] && mkdir ${GENION_STORAGE_DIR}
export PBFUSION_STORAGE_DIR=${RESULTS_STORAGE_DIR}/pbfusion
[ ! -d ${PBFUSION_STORAGE_DIR} ] && mkdir ${PBFUSION_STORAGE_DIR}
export FUSIONSEEKER_STORAGE_DIR=${RESULTS_STORAGE_DIR}/fusionseeker
[ ! -d ${FUSIONSEEKER_STORAGE_DIR} ] && mkdir ${FUSIONSEEKER_STORAGE_DIR}

export ARRIBA_STORAGE_DIR=${RESULTS_STORAGE_DIR}/arriba
[ ! -d ${ARRIBA_STORAGE_DIR} ] && mkdir ${ARRIBA_STORAGE_DIR}
export STARFUSION_STORAGE_DIR=${RESULTS_STORAGE_DIR}/starfusion
[ ! -d ${STARFUSION_STORAGE_DIR} ] && mkdir ${STARFUSION_STORAGE_DIR}

## GRAPH STORAGE DIRECTORIES
export GRAPHS_STORAGE_DIR=${RESULTS_STORAGE_DIR}/graphs
[ ! -d ${GRAPHS_STORAGE_DIR} ] && mkdir ${GRAPHS_STORAGE_DIR}

## RESOURCES
export DNA_REFERENCE_GEN=${REF_STORAGE_DIR}/GRCh38.primary_assembly.genome.fa
export CDNA_REFERENCE_GEN=${REF_STORAGE_DIR}/gencode.v38.transcripts.fa
export GTF_REFERENCE_GEN=${REF_STORAGE_DIR}/gencode.v38.annotation.gtf

export DNA_REFERENCE=${REF_STORAGE_DIR}/GRCh38.primary_assembly.genome.fa
export CDNA_REFERENCE=${REF_STORAGE_DIR}/gencode.v38.transcripts.fa
export GTF_REFERENCE=${REF_STORAGE_DIR}/gencode.v38.annotation.gtf

export DNA_REFERENCE_ENS=${REF_STORAGE_DIR}/Homo_sapiens.GRCh38.dna.primary_assembly.fa
export CDNA_REFERENCE_ENS=${REF_STORAGE_DIR}/Homo_sapiens.GRCh38.cdna.all.fa
export GTF_REFERENCE_ENS=${REF_STORAGE_DIR}/Homo_sapiens.GRCh38.105.gtf

export PBMM2_MMI=${REF_STORAGE_DIR}/hg38_gencode.mmi

export GENSELF=${REF_STORAGE_DIR}/genion-selfalign.tsv

export STAR_INDEX=${REF_STORAGE_DIR}/hg38_star_index

export GENOMIC_SUPER_DUPS=${REF_STORAGE_DIR}/genomicSuperDups.txt

export CTAT_LIB_DIR=${REF_STORAGE_DIR}/GRCh38_gencode_v22_CTAT_lib_Mar012021.plug-n-play

## Annotion Limit Settings
export TRANSCRIPT_LIMIT=canonical
export TRANSCRIPT_LIMITED_FILE=${REF_STORAGE_DIR}/Homo_sapiens_transcriptome_limited_${TRANSCRIPT_LIMIT}.fa

## FUSION SIMULATION SETTINGS
export NFUSIONS=1000
export FUSIM_FASTA_FILE=${REF_STORAGE_DIR}/fusim_${NFUSIONS}.fasta
export FUSIM_TXT_FILE=${REF_STORAGE_DIR}/fusim_${NFUSIONS}.txt
export FUSIM_REF_FILE=${REF_STORAGE_DIR}/fusim_ref_${NFUSIONS}.txt
export FUSION_TRANSCRIPTOME=${REF_STORAGE_DIR}/Homo_sapiens.GRCh38.cdna.limited_${TRANSCRIPT_LIMIT}_fusions_${NFUSIONS}_2.fa

for file in ${DOCKER_SRC}/*.sh; do
  for ((i=0; i<=3; i++)); do
    sed -i 's/.*#REPLACE_N_TRANSCRIPTS.*/N_TRANSCRIPTS='"$N_TRANSCRIPTS"' #REPLACE_N_TRANSCRIPTS/' $file
    sed -i 's/.*#REPLACE_REPLICATES.*/REPLICATES='"$REPLICATES"' #REPLACE_REPLICATES/' $file
    sed -i 's/.*#REPLACE_COVERAGE.*/COVERAGE='"$COVERAGE"' #REPLACE_COVERAGE/' $file
    sed -i 's/.*#REPLACE_QUALITY.*/QUALITY='"$QUALITY"' #REPLACE_QUALITY/' $file
    sed -i 's/.*#REPLACE_TECH.*/TECH='"$TECH"' #REPLACE_TECH/' $file
    sed -i 's/.*#REPLACE_READ_LENGTHS.*/READ_LENGTHS='"$READ_LENGTHS"' #REPLACE_READ_LENGTHS/' $file
    sed -i 's/.*#REPLACE_MIN_OVERLAP_LEN.*/MIN_OVERLAP_LEN='"$MIN_OVERLAP_LEN"' #REPLACE_MIN_OVERLAP_LEN/' $file
    sed -i 's/.*#REPLACE_BIN_SIZE.*/BIN_SIZE='"$BIN_SIZE"' #REPLACE_BIN_SIZE/' $file
    sed -i 's/.*#REPLACE_MIN_MAP_LENGTH.*/MIN_MAP_LENGTH='"$MIN_MAP_LENGTH"' #REPLACE_MIN_MAP_LENGTH/' $file
    sed -i 's/.*#REPLACE_GENION_MIN_SUPPORT.*/GENION_MIN_SUPPORT='"$GENION_MIN_SUPPORT"' #REPLACE_GENION_MIN_SUPPORT/' $file
  done
done

